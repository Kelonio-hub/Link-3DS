<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Archivos Nintendo | La Presa</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/assets/Logo%20Presa.png">

  <style>
    :root{
      --glass-bg: rgba(20,20,20,.65);
      --glass-border: rgba(255,255,255,.15);
      --green: #00ff88;
      --red: #ff2b2b;
      --blue-aura: #00aaff;
    }

    *{box-sizing:border-box}

    body{
      min-height: 100vh;
      font-family: 'Segoe UI', system-ui, sans-serif;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      background:
        linear-gradient(to bottom, rgba(0,0,0,0.5), rgba(0,0,0,0.7)),
        url('https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Fondo.jpg');
      background-size: cover;
      background-position: center;
    }

    /* ================= CONTAINER ================= */
    .container{
      width: 95%;
      max-width: 1100px;
      padding: 40px;
      border-radius: 22px;
      display: grid;
      grid-template-columns: 1fr 260px;
      gap: 30px;
      background: var(--glass-bg);
      backdrop-filter: blur(18px);
      border: 1px solid var(--glass-border);
      box-shadow: 0 25px 60px rgba(0,0,0,0.8);
    }

    /* ================= TEXT + IMAGE ================= */
    .text-image-container{
      display:flex;
      justify-content: space-between;
      align-items:flex-start;
      gap:20px;
      width:100%;
    }

    .text-section p{
      font-size:26px;
      font-weight:800;
      margin-bottom:20px;
      text-shadow:0 0 18px rgba(0,255,136,.4);
    }

    .note{
      font-size:15px;
      line-height:1.6;
      opacity:.85;
    }

    #consoleImageContainer {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      width: 100px;
      flex-shrink: 0;
      justify-content: flex-start;
    }

    #consoleImageContainer img {
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
    }

    /* ================= BUTTONS & LOADING ================= */
    .button-section{
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items: center;
      gap:20px;
      min-height: 120px;
    }

    button{
      padding:16px;
      font-size:18px;
      font-weight:800;
      border:none;
      border-radius:14px;
      cursor:pointer;
      background:var(--red);
      color:#ffffff;
      box-shadow:0 0 20px rgba(255,0,0,.5);
      transition:.3s;
    }

    button:hover{
      transform:translateY(-2px) scale(1.05);
      box-shadow:0 0 30px rgba(255,0,0,.8);
    }

    /* ================= LOADING ================= */
    #loading{
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      padding: 20px;
    }

    #loadingGif{
      width: 150px;
      height: 150px;
      filter: drop-shadow(0 0 20px var(--blue-aura));
    }

    #loadingText{
      text-align: center;
      font-size: 18px;
      font-weight: 800;
      color: var(--blue-aura);
      text-shadow: 
        0 0 10px var(--blue-aura),
        0 0 20px var(--blue-aura),
        0 0 30px var(--blue-aura);
      animation: auraPulse 2s infinite alternate;
      line-height: 1.4;
    }

    @keyframes auraPulse {
      from { text-shadow: 0 0 10px var(--blue-aura), 0 0 20px var(--blue-aura), 0 0 30px var(--blue-aura); }
      to { text-shadow: 0 0 20px var(--blue-aura), 0 0 40px var(--blue-aura), 0 0 60px var(--blue-aura), 0 0 80px var(--blue-aura); }
    }

    /* ================= CONSOLES + SEARCH ================= */
    .console-search-container{
      grid-column:1/-1;
      display:flex;
      gap:15px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:10px;
    }

    .console-selector{
      display:flex;
      flex-wrap:wrap;
      gap:15px;
    }

    .console-button{
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px 18px;
      background:rgba(255,255,255,.08);
      border-radius:16px;
      border:1px solid var(--glass-border);
      font-weight:800;
      cursor:pointer;
      transition:.25s;
    }

    .console-button img{
      width:32px;
      height:32px;
    }

    .console-button:hover{
      transform:translateY(-3px);
      background:rgba(255,136,0,.15);
      box-shadow:0 0 15px rgba(0,255,136,.4);
    }

    .search-bar{
      flex:1;
    }

    .search-bar input{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--glass-border);
      background: rgba(0,0,0,.3);
      color:#fff;
      font-size:16px;
    }

    .search-bar input::placeholder{
      color: rgba(255,255,255,.6);
    }

    /* ================= FILES ================= */
    .files-section{
      grid-column:1/-1;
      display:none;
      flex-direction:column;
      gap:18px;
      margin-top:20px;
      max-height:400px;
      overflow-y:auto;
      padding-right:5px;
    }

    .file-card{
      background:rgba(255,255,255,.06);
      border-radius:14px;
      padding:10px;
      text-align:center;
      cursor:pointer;
      border:2px solid transparent;
      transition:.25s;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .file-card img{
      width:150px;  
      height:84px;  
      border-radius:12px;
      object-fit:cover;
    }

    .file-card:hover{
      transform:translateY(-4px);
      background:rgba(255,255,255,.12);
    }

    /* ================= SOCIAL ================= */
    .social-floating{
      position:fixed;
      bottom:20px;
      left:20px;
      display:flex;
      flex-direction:column;
      gap:12px;
      z-index:3000;
    }

    .social-floating a{
      width:52px;
      height:52px;
      background:rgba(0,0,0,.75);
      border-radius:50%;
      display:flex;
      justify-content:center;
      align-items:center;
      border:1px solid var(--glass-border);
      transition:.3s;
    }

    .social-floating a:hover{
      transform:scale(1.12);
      box-shadow:0 0 15px rgba(255,255,255,.3);
    }

    .social-floating img{
      width:24px;
      height:24px;
    }

    /* ================= LANGUAGE ================= */
    .language-selector{
      position:fixed;
      bottom:20px;
      right:20px;
    }

    .language-selector select{
      padding:6px 10px;
      background:rgba(0,0,0,.8);
      color:#fff;
      border-radius:8px;
      border:1px solid var(--glass-border);
    }

    /* ================= RESPONSIVE ================= */
    @media(max-width:768px){
      .container{
        grid-template-columns:1fr;
        text-align:center;
        padding: 25px 15px;
        gap: 25px;
      }
      .text-image-container{
        flex-direction:column;
        align-items:center;
        gap: 25px;
      }
      #consoleImageContainer{
        width: 220px;
        justify-content: center;
      }
      #consoleImageContainer img {
        width: 100%;
      }
      .text-section p {
        font-size: 22px;
      }
      .note {
        font-size: 14px;
      }
      .console-search-container{
        flex-direction:column;
        align-items:center;
        gap: 20px;
      }
      .console-selector {
        justify-content: center;
      }
      .search-bar{
        width:100%;
        max-width: 350px;
      }
      .file-card {
        flex-direction: column;
        text-align: center;
      }
      .file-card img {
        width: 200px;
        height: 112px;
      }
      .files-section {
        max-height: 500px;
      }
      .social-floating {
        flex-direction: row;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 400px;
        justify-content: center;
      }
      .language-selector {
        bottom: 80px;
        right: 15px;
      }
    }

    @media(max-width:480px){
      .container {
        padding: 20px 10px;
      }
      .text-section p {
        font-size: 20px;
      }
      #consoleImageContainer {
        width: 180px;
      }
      button {
        padding: 14px;
        font-size: 17px;
      }
      #loadingGif {
        width: 120px;
        height: 120px;
      }
      #loadingText {
        font-size: 16px;
      }
      .console-button {
        padding: 10px 14px;
        font-size: 15px;
      }
      .console-button img {
        width: 28px;
        height: 28px;
      }
      .file-card img {
        width: 160px;
        height: 90px;
      }
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="text-image-container">
      <div class="text-section" id="textSection">
        <p id="mainText">¡Suscríbete para acceder al contenido!</p>
        <div class="note" id="instructions">
          1. Haz clic en el botón de suscripción.<br>
          2. Confirma la suscripción en YouTube.<br>
          3. Espera hasta que se verifique la suscripción.<br>
          4. Selecciona la consola y los archivos que deseas descargar.
        </div>
      </div>
      <div id="consoleImageContainer"></div>
    </div>

    <div class="button-section" id="buttonContainer">
      <button id="subscribeBtn">Suscribirse</button>

      <div id="loading">
        <img src="https://64.media.tumblr.com/5b83f8fb1df36abd0f1ce985d4d22428/ac0b4500f5318760-00/s500x750/8de1f8856a67ab5030c799891e1c91e69188ac50.gif" alt="Desbloqueando..." id="loadingGif">
        <div id="loadingText"></div>
      </div>
    </div>

    <div class="console-search-container" id="consoleSearchContainer" style="display:none;">
      <div class="console-selector" id="consoleSelector"></div>
      <div class="search-bar">
        <input type="text" id="fileSearch" placeholder="Buscar archivos...">
      </div>
    </div>

    <div class="files-section" id="filesSection"></div>
  </div>

  <div class="social-floating">
    <a href="https://discord.gg/8Fv8GDg" target="_blank"><img src="https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Presa.png" alt="Discord La Presa"></a>
    <a href="https://discord.com/invite/xHg7XaYJvK" target="_blank"><img src="https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Wiide.png" alt="Discord Wiide"></a>
    <a href="https://x.com/Kelonio3DS" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/5969/5969020.png" alt="X/Twitter"></a>
    <a href="https://github.com/Kelonio-hub" target="_blank"><img src="https://github.githubassets.com/favicons/favicon-dark.png" alt="GitHub"></a>
    <a href="https://www.paypal.com/paypalme/kelohack" target="_blank"><img src="https://static.vecteezy.com/system/resources/previews/067/805/127/non_2x/paypal-logo-square-rounded-paypal-logo-free-download-paypal-logo-free-png.png" alt="Paypal"></a>
    <a href="https://ko-fi.com/lapresa" target="_blank"><img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/ko-fi-icon.png" alt="Ko-fi La Presa"></a>
    <a href="https://ko-fi.com/wiide" target="_blank"><img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/ko-fi-icon.png" alt="Ko-fi Wiide"></a>
  </div>

  <div class="language-selector">
    <select id="language-select" onchange="cambiarIdioma(this.value)">
      <option value="en">English</option>
      <option value="es" selected>Español</option>
    </select>
  </div>

  <script>
    // Traducciones
    const translations = {
      en: {
        mainText: "Subscribe to access content!",
        instructions: "1. Click the subscribe button.<br>2. Confirm subscription on YouTube.<br>3. Wait until the subscription is verified.<br>4. Select the console and the files you want to download.",
        subscribe: "Subscribe",
        loadingText: "Unlocking<br>ancient magic...",
        searchPlaceholder: "Search files..."
      },
      es: {
        mainText: "¡Suscríbete para acceder al contenido!",
        instructions: "1. Haz clic en el botón de suscripción.<br>2. Confirma la suscripción en YouTube.<br>3. Espera hasta que se verifique la suscripción.<br>4. Selecciona la consola y los archivos que deseas descargar.",
        subscribe: "Suscribirse",
        loadingText: "Desbloqueando<br>magia ancestral...",
        searchPlaceholder: "Buscar archivos..."
      }
    };

    let idiomaActual = 'es';

    // Elementos DOM
    const subscribeBtn = document.getElementById('subscribeBtn');
    const loading = document.getElementById('loading');
    const loadingText = document.getElementById('loadingText');
    const consoleSearchContainer = document.getElementById('consoleSearchContainer');
    const consoleSelector = document.getElementById('consoleSelector');
    const filesSection = document.getElementById('filesSection');
    const fileSearchInput = document.getElementById('fileSearch');
    const consoleImageContainer = document.getElementById('consoleImageContainer');

    // CATEGORÍAS
    const categories = [
      { id: 'switch', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Switch.png', label: 'SWITCH' },
      { id: 'nds', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20NDS.png', label: 'NDS' },
      { id: '3ds', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%203DS.png', label: '3DS' },
      { id: 'wii', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Wii.png', label: 'WII' },
      { id: 'SD', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20SD.png', label: 'SD' },
      { id: 'amazon', icon: 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20productos.png', label: 'AMAZON' }
    ];

    let mediaFiles = {};
    let amazonProducts = [];

    // Cambiar idioma
    function cambiarIdioma(lang) {
      idiomaActual = lang;
      document.getElementById('mainText').innerHTML = translations[lang].mainText;
      document.getElementById('instructions').innerHTML = translations[lang].instructions;
      subscribeBtn.innerText = translations[lang].subscribe;
      fileSearchInput.placeholder = translations[lang].searchPlaceholder;
      
      if (loadingText && loading.style.display !== 'none') {
        loadingText.innerHTML = translations[lang].loadingText;
      }
    }

    // Cargar datos desde JSON
    async function cargarDatos() {
      try {
        const [resConsolas, resProductos] = await Promise.all([
          fetch('https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/data/consolas.json'),
          fetch('https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/data/productos.json')
        ]);

        if (!resConsolas.ok || !resProductos.ok) throw new Error('Error al cargar datos');

        mediaFiles = await resConsolas.json();
        amazonProducts = await resProductos.json();
        return true;
      } catch (err) {
        console.error(err);
        alert('Error al cargar los archivos. Recarga la página.');
        return false;
      }
    }

    // Mostrar contenido
    function mostrarContenido(catId) {
      filesSection.innerHTML = '';
      filesSection.style.display = 'flex';
      consoleImageContainer.innerHTML = '';

      const cat = categories.find(c => c.id === catId);
      const img = document.createElement('img');
      img.src = cat.icon;
      img.style.width = '300px';
      consoleImageContainer.appendChild(img);

      const items = (catId === 'amazon') ? amazonProducts : mediaFiles[catId] || [];

      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'file-card';
        card.dataset.url = item.url;
        const thumbnail = item.img || 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Zip.png';
        card.innerHTML = `<img src="${thumbnail}" loading="lazy"><br>${item.label[idiomaActual]}`;
        card.onclick = () => window.open(item.url, '_blank');
        filesSection.appendChild(card);
      });
    }

    // Búsqueda
    fileSearchInput.addEventListener('input', () => {
      const query = fileSearchInput.value.toLowerCase().trim();
      filesSection.innerHTML = '';
      filesSection.style.display = query ? 'flex' : 'none';
      if (!query) return;

      const resultados = [];

      Object.keys(mediaFiles).forEach(consola => {
        mediaFiles[consola].forEach(f => {
          if (f.label[idiomaActual].toLowerCase().includes(query)) resultados.push(f);
        });
      });

      amazonProducts.forEach(p => {
        if (p.label[idiomaActual].toLowerCase().includes(query)) resultados.push(p);
      });

      resultados.forEach(item => {
        const card = document.createElement('div');
        card.className = 'file-card';
        card.dataset.url = item.url;
        const thumbnail = item.img || 'https://raw.githubusercontent.com/Kelonio-hub/Link-3DS/main/Logo%20Zip.png';
        card.innerHTML = `<img src="${thumbnail}" loading="lazy"><br>${item.label[idiomaActual]}`;
        card.onclick = () => window.open(item.url, '_blank');
        filesSection.appendChild(card);
      });
    });

    // EVENTO SUSCRIBIRSE + POPUNDER LIMITADO A 1 VEZ CADA HORA
    subscribeBtn.addEventListener('click', () => {
      // Abre YouTube para suscribirse
      window.open('https://www.youtube.com/channel/UCJbYmHLNcrPUUA9oyBGtsKw?sub_confirmation=1', '_blank');

      // Oculta botón a los 29s
      setTimeout(() => {
        subscribeBtn.style.display = 'none';
      }, 29000);

      // A los 30s: muestra loading
      setTimeout(() => {
        loadingText.innerHTML = translations[idiomaActual].loadingText;
        loading.style.display = 'flex';
      }, 30000);

      // === POPUNDER LIMITADO A 1 VEZ CADA HORA ===
      const POPUNDER_KEY = 'popunder_shown_timestamp';
      const ONE_HOUR = 60 * 60 * 1000; // 1 hora en milisegundos

      const lastShown = localStorage.getItem(POPUNDER_KEY);
      const now = Date.now();

      if (!lastShown || (now - parseInt(lastShown) > ONE_HOUR)) {
        // Solo carga el script del popunder si no se ha mostrado en la última hora
        const popunderScript = document.createElement('script');
        popunderScript.src = 'https://pl28354670.effectivegatecpm.com/67/db/fb/67dbfb62534bf79ffa9a40809f805333.js';
        popunderScript.async = true;
        document.body.appendChild(popunderScript);

        // Guarda la hora actual
        localStorage.setItem(POPUNDER_KEY, now.toString());
      }
      // Si ya se mostró recientemente, no hace nada

      // Desbloqueo a los 60s
      setTimeout(async () => {
        const datosOk = await cargarDatos();

        loading.style.display = 'none';

        if (!datosOk) {
          subscribeBtn.style.display = 'block';
          return;
        }

        consoleSearchContainer.style.display = 'flex';

        categories.forEach(cat => {
          const btn = document.createElement('div');
          btn.className = 'console-button';
          btn.innerHTML = `
            <img src="${cat.icon}">
            <span>${cat.label}</span>
          `;
          btn.onclick = () => mostrarContenido(cat.id);
          consoleSelector.appendChild(btn);
        });

      }, 60000);
    });

    // Iniciar en inglés (como en el original) o mantener español según prefieras
    cambiarIdioma('es');
  </script>
</body>
</html>